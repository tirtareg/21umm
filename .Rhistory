# Predicting Model on Train Data for Logistic Regression
pred.train <- predict(smote_logit, latih, type = "raw")
summary(pred.train)
pred.test <- predict(smote_logit, test2, type = "raw")
test2
test2$age
table(test2$age)
table(latih$age)
train <- read.csv("G:/My Drive/Dian/BRI HACKATON/People Analytic/train.csv")
test <- read.csv("G:/My Drive/Dian/BRI HACKATON/People Analytic/test.csv")
train[train == "Pencapaian 50%-100%"] <- "achiev_50%-100%"
train[train == "Pencapaian 100%-150%"] <- "achiev_100%-150%"
train[train == "Tidak diberikan target"] <- "achiev_< 50%"
train[train == "Pencapaian < 50%"] <- "achiev_< 50%"
train[train == "Pencapaian > 1.5"] <- "achiev_> 1.5"
train[train == "not reached"] <- "not_reached"
test[test == "Pencapaian 50%-100%"] <- "achiev_50%-100%"
test[test == "Pencapaian 100%-150%"] <- "achiev_100%-150%"
test[test == "Tidak diberikan target"] <- "achiev_< 50%"
test[test == "Pencapaian < 50%"] <- "achiev_< 50%"
test[test == "Pencapaian > 1.5"] <- "achiev_> 1.5"
test[test == "not reached"] <- "not_reached"
train <- mutate_if(train, is.character, as.factor)
test <- mutate_if(test, is.character, as.factor)
train <- train %>% mutate_all(na_if, "")
train <- droplevels(train)
test <- droplevels(test)
summary(train$year_graduated)
train <- train[, -16]
test <- test[, -16]
train <- train %>%
relocate(Best.Performance, .after = last_col())
train$Best.Performance <- factor(train$Best.Performance,
levels = c(0,1),
labels = c("not_reached", "reached"))
round(prop.table(table(train$Best.Performance))*100, 0)
a <- colSums(is.na(train))
b <- seq(1,length(a))
d <- round(colSums(is.na(train))/nrow(train)*100, 2)
c <- data.frame(peubah = b, banyaknya_NA = a, persen_NA = d)
arrange(c, desc(persen_NA))
train1 <- train[complete.cases(train), ]
test1 <- test
dim(train1)
table(train1$Best.Performance)
round(prop.table(table(train1$Best.Performance)) * 100, 0)
tipe <- NULL
nama <- NULL
for (i in (1 : (ncol(train1) - 1))) {
tipe[i] <- class(train1[, i])
nama[i] <- names(train1)[i]
}
data.frame(nama = nama, var = 1 : (ncol(train1) - 1), tipe = tipe)
train1$age <- pisah(train1$age, train1$age, 4, "freq")
test1$age <- pisah(train1$age, test1$age, 4, "freq")
train1 <- train[complete.cases(train), ]
test1 <- test
dim(train1)
table(train1$Best.Performance)
round(prop.table(table(train1$Best.Performance)) * 100, 0)
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
train2 <- train1
test2 <- test1
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
train2 <- train1
test2 <- test1
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
train2
test2
train <- read.csv("G:/My Drive/Dian/BRI HACKATON/People Analytic/train.csv")
test <- read.csv("G:/My Drive/Dian/BRI HACKATON/People Analytic/test.csv")
train[train == "Pencapaian 50%-100%"] <- "achiev_50%-100%"
train[train == "Pencapaian 100%-150%"] <- "achiev_100%-150%"
train[train == "Tidak diberikan target"] <- "achiev_< 50%"
train[train == "Pencapaian < 50%"] <- "achiev_< 50%"
train[train == "Pencapaian > 1.5"] <- "achiev_> 1.5"
train[train == "not reached"] <- "not_reached"
test[test == "Pencapaian 50%-100%"] <- "achiev_50%-100%"
test[test == "Pencapaian 100%-150%"] <- "achiev_100%-150%"
test[test == "Tidak diberikan target"] <- "achiev_< 50%"
test[test == "Pencapaian < 50%"] <- "achiev_< 50%"
test[test == "Pencapaian > 1.5"] <- "achiev_> 1.5"
test[test == "not reached"] <- "not_reached"
train <- mutate_if(train, is.character, as.factor)
test <- mutate_if(test, is.character, as.factor)
train <- train %>% mutate_all(na_if, "")
train <- droplevels(train)
test <- droplevels(test)
summary(train$year_graduated)
train <- train[, -16]
test <- test[, -16]
train <- train %>%
relocate(Best.Performance, .after = last_col())
train$Best.Performance <- factor(train$Best.Performance,
levels = c(0,1),
labels = c("not_reached", "reached"))
round(prop.table(table(train$Best.Performance))*100, 0)
a <- colSums(is.na(train))
b <- seq(1,length(a))
d <- round(colSums(is.na(train))/nrow(train)*100, 2)
c <- data.frame(peubah = b, banyaknya_NA = a, persen_NA = d)
arrange(c, desc(persen_NA))
train1 <- train[complete.cases(train), ]
test1 <- test
dim(train1)
table(train1$Best.Performance)
round(prop.table(table(train1$Best.Performance)) * 100, 0)
tipe <- NULL
nama <- NULL
for (i in (1 : (ncol(train1) - 1))) {
tipe[i] <- class(train1[, i])
nama[i] <- names(train1)[i]
}
data.frame(nama = nama, var = 1 : (ncol(train1) - 1), tipe = tipe)
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
# membuat fungsi split berdasarkan kesamaan frequency atau kesamaan lebar selang
pisah <- function(acuan, tujuan, n, method = "length") {
if (method == "freq") {
breaks <- c(-Inf, quantile(acuan, seq(1/n, 1/n*(n-1), by = 1/n)), Inf)
cut(tujuan, breaks)
} else {
selang <- max(acuan) - min(acuan)
breaks <- c(-Inf, seq(min(acuan)+selang/n, max(acuan)-selang/n, by = selang/n), Inf)
cut(tujuan, breaks)
}
}
train2 <- train1
test2 <- test1
train2$age <- pisah(train1$age, train2$age, 4, "freq")
test2$age <- pisah(train1$age, test2$age, 4, "freq")
train2$job_duration_as_permanent_worker <- pisah(train1$job_duration_as_permanent_worker, train2$job_duration_as_permanent_worker, 4, "freq")
test2$job_duration_as_permanent_worker <- pisah(train1$job_duration_as_permanent_worker, test2$job_duration_as_permanent_worker, 4, "freq")
train2$job_duration_from_training <- pisah(train1$job_duration_from_training, train2$job_duration_from_training, 4, "freq")
test2$job_duration_from_training <- pisah(train1$job_duration_from_training, test2$job_duration_from_training, 4, "freq")
train2$branch_rotation <- pisah(train1$branch_rotation, train2$branch_rotation, 4, "freq")
test2$branch_rotation <- pisah(train1$branch_rotation, test2$branch_rotation, 4, "freq")
train2$job_rotation <- pisah(train1$job_rotation, train2$job_rotation, 4, "freq")
test2$job_rotation <- pisah(train1$job_rotation, test2$job_rotation, 4, "freq")
train1[, 25] <- as.factor(train1[, 25])
test1[, 25] <- as.factor(test1[, 25])
train2 <- train2[, -7]
test2 <- test2[, -7]
tipe <- NULL
nama <- NULL
for (i in (1 : (ncol(train2) - 1))) {
tipe[i] <- class(train2[, i])
nama[i] <- names(train2)[i]
}
data.frame(nama = nama, var = 1 : (ncol(train2) - 1), tipe = tipe)
data.frame(nama = nama, var = 1 : (ncol(train2) - 1), tipe = tipe)
preProcess_range_model <- preProcess(train2, method='center')
train2 <- predict(preProcess_range_model, newdata = train2)
test2 <- predict(preProcess_range_model, newdata = test2)
### menjalankan algoritma SMOTE
library(DMwR)
set.seed(1000)
latih <- SMOTE(Best.Performance ~ ., data = train2, k = 5,
perc.over = 200, perc.under = 200)
# Performing Logistic Regression
Control <- trainControl(method = "cv",
number = 5)
smote_logit <- train(Best.Performance ~.,
data = latih,
method = "glmnet",
trControl = Control)
smote_logit
# Predicting Model on Train Data for Logistic Regression
pred.train <- predict(smote_logit, latih, type = "raw")
summary(pred.train)
pred.test <- predict(smote_logit, test2, type = "raw")
summary(pred.test)
hasil <- data.frame(index = 1 : nrow(test1),
`Best Performance` = pred.test)
write.csv(hasil, "hasil_smote_logit_04.csv")
# Performing Logistic Regression
Control <- trainControl(method = "cv",
number = 5)
# Training neural net
smote_ranger <- train(Best.Performance ~ .,
data = latih,
trControl = Control, method = "ranger")
smote_ranger
# Performing Random Forest
Control <- trainControl(method = "cv",
number = 5)
smote_rf <- train(Best.Performance ~ ., data = latih,
trCtrl = Control,
method = "rf")
smote_rf
knitr::opts_chunk$set(echo = TRUE)
library(mlr3)
install.packages(ask = F)
update.packages(ask = F, checkBuilt = T)
dim(iris)
train <- sample(1:150, 0.8*150)
train
latih <- iris[train,]
test <- setdiff(iris, train)
dim(test)
test <- setdiff(iris, latih)
dim(test)
train
setdiff
test <- setdiff(1:150, train)
test
test <- iris[setdiff(1:150, train), ]
test
names(iris)
install.packages('discretization')
library(discretization)
mdlp(latih[, c(1, 5)])
mdlp(latih[, c(1, 5)])$cutp
mdlp(latih[, c(1, 5)])$cutp[[1]]
c(-Inf, mdlp(latih[, c(1, 5)])$cutp[[1]], Inf)
?mdlp
cutIndex(iris)
?cutIndex
cutIndex(iris[,1], iris[,5])
cutIndex(iris[,3], iris[,5])
c(-Inf, mdlp(latih[, c(1, 5)])$cutp[[1]], Inf)
cut(a, test[,1])
a <- c(-Inf, mdlp(latih[, c(1, 5)])$cutp[[1]], Inf)
cut(a, test[,1])
a
test[,1]
?cut
cut(a, test[,1])
cut(test[,1], a)
cut(test[,1], a, labels = F)
cut(train[,1], a, labels = F)
cut(latih[,1], a, labels = F)
library(tidyverse)
mtcars
data <- iris
head(data)
data %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length))
data %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length))
View(data %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length)))
data %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2)
data %>%
group_by(Species) %>%
summarise(rata2 = mean(Sepal.Length))
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2)
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2,
delta2 = delta^2)
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2,
delta2 = delta^2,
n = n())
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2,
delta2 = delta^2,
n = n()) %>%
group_by(Species) %>%
summarize(sd = sqrt(sum(delta2)/mean(n)))
data %>%
group_by(Species) %>%
summarise(rata2 = mean(Sepal.Length),
sd = sd(Sepal.Length))
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2,
delta2 = delta^2,
n = n()) %>%
group_by(Species) %>%
summarize(sd = sqrt(sum(delta2)/(mean(n)-1)))
data %>%
select(Sepal.Length, Species) %>%
group_by(Species) %>%
mutate(rata2 = mean(Sepal.Length),
delta = Sepal.Length - rata2,
delta2 = delta^2,
n = n())
library(tidyverse)
table1
table2
table3
table4
table4a
table4b
dim(table1)
table1
table1 %>%
mutate(rate = case / population * 100)
table1 %>%
mutate(rate = cases / population * 100)
table1 %>%
mutate(rate = cases / population * 10000)
table1 %>%
group_by(year) %>%
summarise(case = sum(cases))
table1 %>%
group_by(year) %>%
summarise(n = sum(cases))
# cases per year
table1 %>%
count(year, wt = cases)
library(ggplot2)
ggplot(table1, aes(year, cases))
ggplot(table1, aes(year, cases)) +
geom_line()
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country))
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country), color = "grey50")
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country), color = "grey50") +
geom_point(aes(colour = country))
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country), colour = "grey50") +
geom_point(aes(colour = country))
update.packages(ask = F, checkBuilt = T)
update.packages(ask = F, checkBuilt = T)
library(xfun)
remove.packages("xfun", lib="~/R/win-library/4.1")
install.packages("xfun", lib="~/R/win-library/4.1", dependencies = T)
install.packages("xfun", lib = "~/R/win-library/4.1", dependencies = T)
update.packages(ask = F, checkBuilt = T)
q()
update.packages(ask = F, checkBuilt = T)
update.packages(ask = F, checkBuilt = T)
library(readxl)
setwd("G:/My Drive/#PMB/2021/04_D3 dan Alih Jenjang/21umm")
dir()
db <- read_excel("data_de.xlsx")
db <- read_excel("data_d3.xlsx")
names(db)
db <- read_excel("data_d3.xlsx")
library(tidyverse)
names(db)
data <- db %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12))
data
data <- db %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
complete.cases()
data
data <- db %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit()
data
db %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit() %>%
nrow()
nrow(data)
data <- db %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit()
data %>% nrow()
data %>%
filter(lulus == "lulus", `Jalur Masuk` == "UMM D3") %>% nrow()
db %>% filter(lulus == "lulus", `Jalur Masuk` == "UMM D3") %>% nrow()
library(flexdashboard)
Sys.setlocale("LC_TIME", "IND")
#library(flipTime)
#UpdateEvery(1, "hours", options = "wakeup")
library(readxl)
library(tidyverse)
db <- read_excel("data_d3.xlsx")
data <- db %>%
group_by(prodi) %>%
filter(`Jalur Masuk` == "UMM D3") %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit()
data
sum(data$minat)
data <- db %>%
filter(`Jalur Masuk` == "UMM D3", lulus == "lulus")
nrow(db)
db <- read_excel("data_d3.xlsx")
data <- db %>%
filter(`Jalur Masuk` == "UMM D3", lulus == "lulus")
female <- filter(data, jk == "P")
nrow(female)/nrow(data)*100
round(nrow(male)/nrow(data)*100
nrow(male)/nrow(data)*100
male <- data %>%
filter(jk == "L")
nrow(male)/nrow(data)*100
nim = nrow(filter(data, diterima == "diterima"))
nim
nim/nrow(data) * 100
data
data <- data %>%
group_by(fakultas, prodi) %>%
summarize(pendaftar = max(pendaftar_p12),
lulus = sum(lulus == "lulus", na.rm = T),
diterima = sum(diterima == "diterima", na.rm = T))
data
library(kableExtra)
kable(data)
names(data) <- c("FAKULTAS", "PROGRAM STUDI", "PEMINAT", "LULUS SELEKSI", "DITERIMA")
kable(data)
kable(data, row.names = F) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down")
library(janitor)
data <- adorn_totals(data, where = "row", name = "Total")
data
kable(data, row.names = F) %>%
kable_styling(bootstrap_options = "striped", full_width = F,
latex_options = "scale_down")
dim(data)
data
data <- db %>%
filter(`Jalur Masuk` == "UMM D3", diterima == "diterima")
data
names(data)
?kable_styling
?datatable
dir()
db <- read_excel("data_pasca.xlsx")
names(db)
db <- read_excel("data_pasca.xlsx")
names(db)
db <- read_excel("data_pasca.xlsx")
data <- db %>%
group_by(jenjang, prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit()
data
data <- db %>%
filter(jenjang == "S2")
data <- db %>%
filter(jenjang == "S2") %>%
group_by(prodi) %>%
summarize(minat = max(pendaftar_p12)) %>%
na.omit()
data
setwd("G:/My Drive/#PMB/2021/04_D3 dan Alih Jenjang/21umm")
